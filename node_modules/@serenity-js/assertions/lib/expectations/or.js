"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.or = void 0;
const Expectation_1 = require("../Expectation");
const outcomes_1 = require("../outcomes");
function or(...assertions) {
    return new Or(assertions);
}
exports.or = or;
/**
 * @package
 */
class Or extends Expectation_1.Expectation {
    constructor(expectations) {
        super(expectations
            .map(assertion => assertion.toString())
            .join(Or.Separator));
        this.expectations = expectations;
    }
    answeredBy(actor) {
        return (actual) => this.expectations.reduce((previous, current) => previous.then((outcomesSoFar) => current.answeredBy(actor)(actual)
            .then(outcome => outcomesSoFar.concat(outcome))), Promise.resolve([])).
            then((outcomes) => {
            const unmetExpectations = outcomes.filter(outcome => outcome instanceof outcomes_1.ExpectationNotMet), message = outcomes.map(outcome => outcome.message).join(Or.Separator);
            return unmetExpectations.length === this.expectations.length
                ? new outcomes_1.ExpectationNotMet(message, outcomes[0].expected, outcomes[0].actual)
                : new outcomes_1.ExpectationMet(message, outcomes[0].expected, outcomes[0].actual);
        });
    }
}
Or.Separator = ' or ';
//# sourceMappingURL=or.js.map