"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.containAtLeastOneItemThat = void 0;
const io_1 = require("@serenity-js/core/lib/io");
const Expectation_1 = require("../Expectation");
const outcomes_1 = require("../outcomes");
function containAtLeastOneItemThat(expectation) {
    return new ContainAtLeastOneItemThatMeetsExpectation(expectation);
}
exports.containAtLeastOneItemThat = containAtLeastOneItemThat;
/**
 * @package
 */
class ContainAtLeastOneItemThatMeetsExpectation extends Expectation_1.Expectation {
    constructor(expectation) {
        super(io_1.formatted `contain at least one item that does ${expectation}`);
        this.expectation = expectation;
    }
    answeredBy(actor) {
        return (actual) => actual.length === 0
            ? Promise.resolve(new outcomes_1.ExpectationNotMet(this.toString(), null, actual))
            : Promise.all(actual.map(item => this.expectation.answeredBy(actor)(item)))
                .then(results => results.some(result => result instanceof outcomes_1.ExpectationMet)
                ? new outcomes_1.ExpectationMet(this.toString(), results[0].expected, actual)
                : new outcomes_1.ExpectationNotMet(this.toString(), results[0].expected, actual));
    }
}
//# sourceMappingURL=containAtLeastOneItemThat.js.map